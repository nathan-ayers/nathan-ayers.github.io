<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Power BI Performance Report (Switch Measures & YTD vs PYTD)</title>
  <style>
    /* Base */
    body { font-family: sans-serif; margin: 0; padding: 2rem; color: #333; }
    .container { max-width: 960px; margin: 0 auto; }

    /* Hero */
    h1 { text-align: center; margin-bottom: 0.25em; }
    .subtitle { text-align: center; margin-top: 0; color: #555; }

    /* Quick Stats */
    .stats { display: flex; justify-content: center; gap: 3rem; margin: 2rem 0; }
    .stat h2 { font-size: 2rem; margin: 0; }
    .stat p { margin: 0.25em 0 0; }

    /* Section Headings */
    h2 { text-align: center; margin: 3rem 0 1rem; }

    /* Screenshots */
    .compare {
      display: flex; flex-wrap: wrap; justify-content: center; gap: 2rem;
    }
    .compare figure {
      position: relative; overflow: visible; flex: 1 1 300px; max-width: 45%; text-align: center;
      isolation: isolate; /* prevent hover layer being clipped by siblings */
    }
    .compare img {
      display: block; width: 100%; height: auto; max-width: 600px;
      border: 1px solid #ddd; border-radius: 4px; box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      cursor: zoom-in; transition: transform 0.3s ease, box-shadow 0.3s ease; transform-origin: center center;
    }
    .compare img:hover {
      transform: scale(2.2); box-shadow: 0 8px 20px rgba(0,0,0,0.2);
      position: relative; z-index: 999; background: #fff;
    }
    .compare figcaption { margin-top: 0.5rem; color: #444; }

    /* Lists / code */
    ul { list-style: none; padding: 0; }
    ul li { margin: 0.75em 0; }
    ul ul { margin: 0.5em 0 0 1.5em; }
    code {
      background: #f6f8fa; padding: 0.2em 0.4em; border-radius: 3px; font-family: monospace;
    }
    pre { background: #f6f8fa; padding: 1rem; border-radius: 4px; overflow-x: auto; }

    /* Footer Links */
    .footer-links { text-align: center; margin: 3rem 0 1rem; }
    .footer-links a { color: #0066cc; text-decoration: none; margin: 0 0.5em; }
    .footer-links a:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <div class="container">

    <!-- Hero -->
    <h1>Power BI Performance Report</h1>
    <p class="subtitle">
      Excel → Power Query (clean) → DAX model (Switch, YTD, PYTD) → Interactive visuals, conditional formatting, dynamic titles → Published to Power BI Service
    </p>

    <!-- Quick Stats -->
    <div class="stats">
      <div class="stat">
        <h2>3 Tables + Calendar</h2>
        <p class="subtitle">Fact Sales · Dim Product · Dim Account · Dim Date</p>
      </div>
      <div class="stat">
        <h2>Switch Measures</h2>
        <p class="subtitle">Sales · Gross Profit · Quantity</p>
      </div>
      <div class="stat">
        <h2>Comparatives</h2>
        <p class="subtitle">YTD vs PYTD · Bottom 10 by Country</p>
      </div>
    </div>

    <!-- Gallery -->
    <h2>Report Screenshots</h2>
    <div class="compare">
      <figure>
        <img src="./assets/overview.png" alt="Overview with header metrics and slicers">
        <figcaption>Overview (header metrics, slicers, switchable metrics)</figcaption>
      </figure>
      <figure>
        <img src="./assets/waterfall.png" alt="Waterfall breakdown YTD vs PYTD by month/country/product">
        <figcaption>Waterfall: YTD − PYTD (drill: month → country → product)</figcaption>
      </figure>
      <figure>
        <img src="./assets/combo.png" alt="Combo chart YTD vs PYTD with product-type legend">
        <figcaption>Combo: YTD (cols) vs PYTD (line) with product legend</figcaption>
      </figure>
      <figure>
        <img src="./assets/bottom.png" alt="Bottom 10 countries by YTD vs PYTD">
        <figcaption>Bottom 10 Countries by YTD vs PYTD</figcaption>
      </figure>
      <figure>
        <img src="./assets/scatter_accounts.png" alt="Account profitability segmentation scatter with zoom & averages">
        <figcaption>Account Profitability: GP% vs value with zoom & averages</figcaption>
      </figure>
    </div>

    <!-- What the slicers can do -->
    <h2>How to Use the Slicers</h2>
    <ul>
      <li><strong>Value Slicer (Switch):</strong> toggle the whole report between <code>Sales</code>, <code>Gross Profit</code>, and <code>Quantity</code> using a single measure switch—cards, charts, and comparisons update in sync.</li>
      <li><strong>Year Slicer:</strong> pick the analysis year; YTD respects the max invoice date in that year, while PYTD lines up the same period last year (no empty future months).</li>
      <li><strong>Drill paths:</strong> waterfall supports <em>Month → Country → Product Type → Product Name</em> so you can pinpoint drivers of declines or growth.</li>
      <li><strong>Account segmentation:</strong> the scatter adds average lines for both GP% and value, with zoom sliders to isolate outliers and opportunity clusters.</li>
    </ul>

    <!-- Key Features -->
    <h2>Key Features</h2>
    <ul>
      <li><strong>Power Query cleanup:</strong> imported three Excel tabs, renamed to <code>Fact Sales</code>, <code>Dim Product</code>, <code>Dim Account</code>; fixed types, de-duplicated keys; added a Calendar table (Dim Date).</li>
      <li><strong>Robust DAX model:</strong> base measures (Sales, COGS, GP), YTD/PYTD built on invoice date and a DimDate <code>InPast</code> flag to align partial years; “Switch” measures driven by a slicer table.</li>
      <li><strong>Comparative analytics:</strong> <em>YTD vs PYTD</em> comparison and a “Bottom 10 by Country” treemap to surface underperformers instantly.</li>
      <li><strong>Explainable visuals:</strong> combo chart (YTD vs PYTD line), a layered waterfall to show drivers, and an account profitability scatter (GP% vs metric) with average lines and zoom.</li>
      <li><strong>UX polish:</strong> dynamic chart titles, color rules (e.g., negative comps in red), consistent layout, and hover-friendly zoom on screenshots here.</li>
    </ul>

    <!-- DAX Snippets (concise) -->
    <h2>Representative DAX</h2>
    <pre><code>// Base measures
Sales := SUM('Fact Sales'[Sales])
COGS  := SUM('Fact Sales'[COGS])
GP    := [Sales] - [COGS]

// YTD / PYTD (YTD uses invoice date to respect partial years)
YTD Sales :=
TOTALYTD([Sales], 'Fact Sales'[Invoice Date])

PYTD Sales :=
CALCULATE(
  [Sales],
  SAMEPERIODLASTYEAR('Dim Date'[Date]),
  'Dim Date'[InPast] = TRUE()
)

// Slicer table (Enter Data): values = {"Sales","Gross Profit","Quantity"}

// Switch (YTD shown; PYTD similar with PYTD measures)
YTD (Switch) :=
VAR sel = SELECTEDVALUE('Slicer Values'[Value])
RETURN
  SWITCH(sel,
    "Sales",        [YTD Sales],
    "Gross Profit", CALCULATE([GP], DATESYTD('Fact Sales'[Invoice Date])),
    "Quantity",     TOTALYTD(SUM('Fact Sales'[Quantity]), 'Fact Sales'[Invoice Date]),
    BLANK()
  )

// Comparison
YTD vs PYTD := [YTD (Switch)] - [PYTD (Switch)]
</code></pre>

    <!-- Workflow -->
    <h2>Process</h2>
    <ul>
      <li><strong>Acquire & Clean:</strong> Import Excel → Power Query tidy-up (rename tables, fix types, remove dupes) → create Dim Date & “InPast” flag.</li>
      <li><strong>Model & Measures:</strong> relationships (Dim → Fact), base measures, YTD/PYTD, Switch measures, comparison metric.</li>
      <li><strong>Visuals & Formatting:</strong> header KPI cards with conditional formatting, Bottom-10 treemap, combo (YTD vs PYTD), waterfall with drill, scatter (GP% vs value) with averages & zoom, dynamic titles.</li>
      <li><strong>Publish:</strong> Power BI Service for sharing with stakeholders.</li>
    </ul>

    <!-- Links -->
    <div class="footer-links">
      <a href="https://github.com/your-username/powerbi-performance-report" target="_blank">View on GitHub ↗</a>
      <!-- <a href="https://app.powerbi.com/links/your-report-link" target="_blank">Open Interactive Report ↗</a> -->
    </div>

  </div>
</body>
</html>
